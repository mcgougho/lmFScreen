% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/selectivePvalue.R
\name{get_pselb}
\alias{get_pselb}
\title{Compute the Selective P-Value Function for Beta1}
\usage{
get_pselb(
  X,
  y,
  sigma_sq,
  yPy = NULL,
  rss = NULL,
  alpha_ov = 0.05,
  B = 10000,
  min_select = B,
  B_max = 1e+07,
  seed = NULL,
  verbose = FALSE
)
}
\arguments{
\item{X}{A matrix of predictor variables.}

\item{y}{A vector of response variables.}

\item{sigma_sq}{The variance parameter.}

\item{rss}{The residual sum of squares from a model fit (default: NULL, computed internally if missing).}

\item{alpha_ov}{The significance level for the overall F-test (default: 0.05).}

\item{B}{The number of Monte Carlo samples used for estimation.}

\item{min_select}{The minimum number of selected samples required (default: `B`).}

\item{seed}{A seed value for reproducibility (default: 123456).}
}
\value{
A function `pselb(b)` that computes the selective p-value for a given `b`.
If the overall F-test fails, the function returns `NA`.
}
\description{
This function returns a function `pselb` that computes the selective p-value
for a given value of `b` (corresponding to `beta1`). The function uses
a Monte Carlo approach to evaluate the probability that the estimated coefficient
satisfies a selection criterion.
}
\details{
The function performs the following steps:
1. Computes the overall F-statistic for the regression model and checks whether it
   passes the selection criterion based on the quantile of an F-distribution.
2. Constructs an orthonormal basis using the singular value decomposition (SVD)
   of `X` excluding the first column.
3. Defines a Monte Carlo estimation approach using random samples from normal
   and chi-squared distributions to approximate the conditional probability.
4. Returns a function `pselb(b)` that evaluates the p-value for any given `b`.
}
