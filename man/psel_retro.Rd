% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/selectivePvalue.R
\name{psel_retro}
\alias{psel_retro}
\title{Retrospective Selective P-Value Based on Summary Statistics}
\usage{
psel_retro(
  n,
  p,
  R_squared,
  RSE,
  tstat,
  sigma_sq = NULL,
  alpha_ov = 0.05,
  B = 1e+06,
  min_select = 1000,
  max_attempts = 100
)
}
\arguments{
\item{n}{Sample size (number of observations).}

\item{p}{Number of predictors used in F-screening (excluding the intercept).}

\item{R_squared}{R-squared from the fitted linear model.}

\item{RSE}{Residual standard error from the fitted model.}

\item{tstat}{Observed t-statistic for the follow-up hypothesis test of beta_j.}

\item{sigma_sq}{Optional estimate of the noise variance. If NULL, uses debiased estimate that accounts for selection.}

\item{alpha_ov}{Significance level for the overall F-test. Default is 0.05.}

\item{B}{Number of Monte Carlo samples per iteration. Default is 1,000,000.}

\item{min_select}{Minimum number of samples satisfying the selection condition. Default is 1,000.}

\item{max_attempts}{Maximum number of iterations for passing selection criterion before giving up. Default is 100.}
}
\value{
A numeric value representing the estimated selective p-value.
If no selected samples are obtained after max_attempts, the function returns NA and issues a warning.
}
\description{
This function is useful for conducting valid retrospective F-screening.
Suppose that we have access to the outputs of a least squares linear regression model, such as from the output of summary(lm(y~X)),
and we want to conduct a test of the significance of a single regression coefficient (beta_j) that accounts for the rejection of the overall F-test.
Then this function can provide a selective p-value for beta_j based on of only a few summary statistics.
The arguments of this function include R-squared, residual standard error (RSE), and an F-statistic for the test of H_0: beta_j=0.
This function is especially useful in settings where the raw data is unavailable, such as published studies.
}
\examples{
data(mtcars)
mod <- lm(mpg ~ wt + hp, data = mtcars)
rse <- summary(mod)$sigma
r2 <- summary(mod)$r.squared
t_hp <- summary(mod)$coefficients["hp", "t value"]
psel_retro(n=nrow(mtcars), p=2, R_squared=r2, RSE=rse, tstat=t_hp)
result <- lmFScreen(mpg ~ wt + hp, data = mtcars)
result[["selective pvalues"]][2]
# the retrospective and prospective p-values coincide (up to Monte Carlo error)

}
