% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/selectiveMLE.R
\name{compute_likelihood_function}
\alias{compute_likelihood_function}
\title{Construct the Selective Log-Likelihood Function for beta1}
\usage{
compute_likelihood_function(
  X,
  y,
  sigma_sq,
  alpha_ov = 0.05,
  B = 1e+06,
  seed = 12345
)
}
\arguments{
\item{X}{A numeric matrix of predictors (n x p), with `beta1` corresponding to the first column.}

\item{y}{A numeric response vector of length n.}

\item{sigma_sq}{The noise variance.}

\item{alpha_ov}{The significance level for the overall F-test (default: `0.05`).}

\item{B}{The number of Monte Carlo samples (default: `1e6`).}

\item{seed}{A seed for reproducibility (default: `12345`).}
}
\value{
A function of one argument `beta1` that returns the approximate
        log-likelihood, conditional on selection.
        If the observed data fails the selection condition, the function returns `-Inf`.
}
\description{
This function constructs a log-likelihood function for a single regression
coefficient (`beta1`), conditional on selection via the overall F-test.
The log-likelihood is approximated using Monte Carlo integration.
}
\details{
The likelihood is proportional to the conditional density of a test statistic
(a linear projection of `y`) given that the observed F-statistic exceeds its
critical value under the null. The selection region is defined using the
F-test threshold and the orthogonal projection structure of the regression.

Internally, the function generates samples from a noncentral and central chi-squared
distribution to approximate the conditional probability of selection.
}
