% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/lmFScreen.R
\name{lmFScreen}
\alias{lmFScreen}
\title{lmFScreen: Valid F-screening}
\usage{
lmFScreen(
  formula,
  data,
  alpha = 0.05,
  alpha_ov = 0.05,
  sigma_sq = NULL,
  compute_CI = TRUE,
  compute_est = TRUE,
  B = 1e+05
)
}
\arguments{
\item{formula}{A formula specifying the linear model (e.g., y ~ x1 + x2).}

\item{data}{An optional data frame containing the variables in the model.}

\item{alpha}{Significance level for confidence intervals and hypothesis tests (default: 0.05).}

\item{alpha_ov}{Significance level for the overall F-test used for screening (default: 0.05).}

\item{sigma_sq}{Optional noise variance. If NULL, it is estimated using a corrected residual variance.}

\item{compute_CI}{Logical; whether to compute selective confidence intervals (default: TRUE).}

\item{compute_est}{Logical; whether to compute selective point estimates (default: TRUE).}

\item{B}{Number of Monte Carlo samples used for selective inference (default: 100000).}
}
\value{
An object of class lmFScreen, which includes:
\itemize{
\item Selective coefficients, confidence intervals, and p-values
\item Standard (unadjusted) estimates, confidence intervals, and p-values
\item Model-level settings such as alpha and alpha_ov
}
}
\description{
This function takes as input a design matrix X and an output vector Y and fits a least squares linear regression model. It then conducts F-screening (via the function lmFScreen.fit) as follows:
}
\details{
(1) it first tests the overall hypothesis that all coefficients (exlcuding the intercept) in the linear regression are zero using an F-test, and

(2) if (and only if) this overall test is rejected, it outputs selective p-values, confidence intervals, and point estimates for the coefficients in the linear regression model.

If the overall test is not not rejected, this function returns the overall F-statistic and p-value and indicates that it is not significant.
If an intercept is present in the model, the data are projected to remove the intercept
before conducting inference.

This function performs the following steps:
\enumerate{
\item Converts the formula into a model matrix and response vector.
\item Projects out the intercept if one is included in the formula.
\item Calls lmFScreen.fit to compute selective inference results for all predictors.
}
}
\examples{

# EXAMPLE 1
data(mtcars)
result <- lmFScreen(mpg ~ wt + hp, data = mtcars)
summary(result)
coef(result)
confint(result)
# in example 1 the overall F-test has a p-value close to zero, so there is essentially no need to account for selection

# EXAMPLE 2
set.seed(50)
X <- matrix(rnorm(100), ncol = 5)
y <- rnorm(20)
result <- lmFScreen(y ~ X)
# in example 2, the overall F-test is not rejected

# EXAMPLE 3
set.seed(100)
X <- matrix(rnorm(100), ncol = 5)
beta <- c(.5,.4,.3,.2,.1)
y <- X \%*\% beta + rnorm(20)
result <- lmFScreen(y ~ X)
summary(result)
coef(result)
confint(result)
# in Example 3, the selective p-values change significantly from the standard p-values

}
