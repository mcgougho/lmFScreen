<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<title>lmFScreen • lmFScreen</title>
<script src="deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="deps/bootstrap-5.2.2/bootstrap.min.css" rel="stylesheet">
<script src="deps/bootstrap-5.2.2/bootstrap.bundle.min.js"></script><link href="deps/font-awesome-6.4.2/css/all.min.css" rel="stylesheet">
<link href="deps/font-awesome-6.4.2/css/v4-shims.min.css" rel="stylesheet">
<script src="deps/headroom-0.11.0/headroom.min.js"></script><script src="deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="deps/search-1.0.0/fuse.min.js"></script><script src="deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="pkgdown.js"></script><meta property="og:title" content="lmFScreen">
<meta name="description" content='F-screening a common two step procedure in the context of least squares linear regression. The first step of F-screening is to conduct an overall F-test that tests whether all of the coefficients in the linear model are zero (excluding the intercept). If this null hypothesis is rejected, the second step is to conduct inference on individual coefficients in the model. If instead the null hypothesis is not rejected, no further inference is conducted. If step 2 in F-screening is conducted without accounting for step 1, statistical guarantees such as type 1 error control and nominal confidence interval coverage break down. As a solution, the paper "Valid F-screening in linear regression" develops p-values, confidence intervals, and point estimates to use in step 2 that condition on the rejection of the overall F-test in step 1. This package provides functions to implement these methods.'>
<meta property="og:description" content='F-screening a common two step procedure in the context of least squares linear regression. The first step of F-screening is to conduct an overall F-test that tests whether all of the coefficients in the linear model are zero (excluding the intercept). If this null hypothesis is rejected, the second step is to conduct inference on individual coefficients in the model. If instead the null hypothesis is not rejected, no further inference is conducted. If step 2 in F-screening is conducted without accounting for step 1, statistical guarantees such as type 1 error control and nominal confidence interval coverage break down. As a solution, the paper "Valid F-screening in linear regression" develops p-values, confidence intervals, and point estimates to use in step 2 that condition on the rejection of the overall F-test in step 1. This package provides functions to implement these methods.'>
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-primary" data-bs-theme="dark" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="index.html">lmFScreen</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.1.1</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item"><a class="nav-link" href="articles/lmFScreen.html">Using lmFScreen</a></li>
<li class="nav-item"><a class="nav-link" href="articles/psel_retro.html">Using psel_retro</a></li>
<li class="nav-item"><a class="nav-link" href="reference/index.html">Reference</a></li>
      </ul>
<ul class="navbar-nav">
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/mcgougho/lmFScreen"><span class="fa fab fa-github"></span></a></li>
      </ul>
</div>


  </div>
</nav><div class="container template-home">
<div class="row">
  <main id="main" class="col-md-9"><p>** If you are viewing this on GitHub, see to the following website for a more readable version ** <a href="https://mcgougho.github.io/lmFScreen/"><img src="https://img.shields.io/badge/docs-pkgdown-blue.svg" alt="pkgdown"></a></p>
<div class="section level2">
<h2 id="what-is-f-screening">What is F-screening?<a class="anchor" aria-label="anchor" href="#what-is-f-screening"></a>
</h2>
<p>Suppose that we have and <math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>n</mi><annotation encoding="application/x-tex">n</annotation></semantics></math>-vector <math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>Y</mi><annotation encoding="application/x-tex">Y</annotation></semantics></math> containing a quantitative response for <math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>n</mi><annotation encoding="application/x-tex">n</annotation></semantics></math> obserations and an <math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>n</mi><mo>×</mo><mi>p</mi></mrow><annotation encoding="application/x-tex">n\times p</annotation></semantics></math> design matrix <math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>X</mi><annotation encoding="application/x-tex">X</annotation></semantics></math> containing <math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>p</mi><annotation encoding="application/x-tex">p</annotation></semantics></math> covariates/features for each of <math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>n</mi><annotation encoding="application/x-tex">n</annotation></semantics></math> observations. Out interest lies in the linear model <math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>Y</mi><mo>=</mo><mi>X</mi><mi>β</mi><mo>+</mo><mi>ϵ</mi></mrow><annotation encoding="application/x-tex">Y = X\beta +\epsilon</annotation></semantics></math>.</p>
<p>A common data analysis pipeline, which we refer to as “F-screening” is as follows:</p>
<ol style="list-style-type: decimal">
<li>Test the “overall” null hypothesis, <math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>H</mi><mn>0</mn></msub><mo>:</mo><msub><mi>β</mi><mn>1</mn></msub><mo>=</mo><msub><mi>β</mi><mn>2</mn></msub><mo>=</mo><mi>.</mi><mi>.</mi><mi>.</mi><mo>=</mo><msub><mi>β</mi><mi>p</mi></msub><mo>=</mo><mn>0</mn></mrow><annotation encoding="application/x-tex">H_0: \beta_1 = \beta_2 = ... = \beta_p = 0</annotation></semantics></math> using an F-test.</li>
<li>
<strong>if (and only if)</strong> this test is rejected, conduct inference on <math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>β</mi><mi>j</mi></msub><annotation encoding="application/x-tex">\beta_j</annotation></semantics></math> for some coefficient <math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>j</mi><annotation encoding="application/x-tex">j</annotation></semantics></math>.</li>
</ol>
<p>Typically, Steps 1 and 2 are carried out using, e.g., the command <code>lm(Y~X)</code>. (However, as will be explained in the next paragraph, this analysis pipeline is problematic.)</p>
<p>While F-screening is intuitive and widely used, carrying out Step 2 using a “standard” approach – for instance, testing <math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msubsup><mi>H</mi><mn>0</mn><mi>j</mi></msubsup><mo>:</mo><msub><mi>β</mi><mi>j</mi></msub><mo>=</mo><mn>0</mn></mrow><annotation encoding="application/x-tex">H_{0}^j: \beta_j=0</annotation></semantics></math> using the t-test output by <code>lm(Y~X)</code> – is problematic, as it does not account for the fact that we conduct inference on <math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>β</mi><mi>j</mi></msub><annotation encoding="application/x-tex">\beta_j</annotation></semantics></math> only if we rejected the “overall” null hypothesis in Step 1. Consequently, the standard t-test for <math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msubsup><mi>H</mi><mn>0</mn><mi>j</mi></msubsup><mo>:</mo><msub><mi>β</mi><mi>j</mi></msub><mo>=</mo><mn>0</mn></mrow><annotation encoding="application/x-tex">H_{0}^j: \beta_j=0</annotation></semantics></math> will not control the Type 1 error, standard confidence intervals for <math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>β</mi><mi>j</mi></msub><annotation encoding="application/x-tex">\beta_j</annotation></semantics></math> will not attain the nominal coverage, and even the point estimate for <math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>β</mi><mi>j</mi></msub><annotation encoding="application/x-tex">\beta_j</annotation></semantics></math> output by <code>lm(Y~X)</code> will be biased.</p>
<p>The <code>lmFScreen</code> package provides a valid inferential toolbox for conducting Step 2 in the F-screening procedure, by accounting for the fact that we conduct inference on <math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>β</mi><mi>j</mi></msub><annotation encoding="application/x-tex">\beta_j</annotation></semantics></math> in Step 1 only if we reject the overall null hypothesis in Step 1.</p>
<p>This inferential toolbox falls under the larger umbrella of “conditional selective inference”, where the “selection event” that we are conditioning on is rejection of the overall null hypothesis in Step 1.</p>
<hr>
</div>
<div class="section level2">
<h2 id="installation">Installation<a class="anchor" aria-label="anchor" href="#installation"></a>
</h2>
<p>To install the <code>lmFScreen</code> package from GitHub, run the following in your R console: <code>devtools::install_github("mcgougho/lmFScreen")</code>.</p>
<hr>
</div>
<div class="section level2">
<h2 id="prospective-inference-with-lmfscreen-function">Prospective inference with <code>lmFScreen</code> function<a class="anchor" aria-label="anchor" href="#prospective-inference-with-lmfscreen-function"></a>
</h2>
<p>The <code>lmFScreen</code> function enables valid inference conditional on rejection of an overall F-test in linear regression, using tools from conditional selective inference.</p>
<p>Given a design matrix <code>X</code> and a response vector <code>y</code>, the package:</p>
<ol style="list-style-type: decimal">
<li>Tests overall F-test of the overall null hypothesis <math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>H</mi><mn>0</mn></msub><mo>:</mo><msub><mi>β</mi><mn>1</mn></msub><mo>=</mo><msub><mi>β</mi><mn>2</mn></msub><mo>=</mo><mi>.</mi><mi>.</mi><mi>.</mi><mo>=</mo><msub><mi>β</mi><mi>p</mi></msub><mo>=</mo><mn>0</mn></mrow><annotation encoding="application/x-tex">H_0: \beta_1 = \beta_2 = ... = \beta_p = 0</annotation></semantics></math> using <code>lm(y~x)</code>
</li>
<li>If this test is rejected, conduct inference on specified coefficients (<code>test_cols</code>)</li>
<li>Returns:
<ul>
<li>Selective <strong>p-values</strong> for <math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msubsup><mi>H</mi><mn>0</mn><mi>j</mi></msubsup><mo>:</mo><msub><mi>β</mi><mi>j</mi></msub><mo>=</mo><mn>0</mn></mrow><annotation encoding="application/x-tex">H_0^j:\beta_j=0</annotation></semantics></math>
</li>
<li>Selective <strong>confidence intervals</strong> for <math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>β</mi><mi>j</mi></msub><annotation encoding="application/x-tex">\beta_j</annotation></semantics></math>
</li>
<li>Selective <strong>point estimates</strong> for <math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>β</mi><mi>j</mi></msub><annotation encoding="application/x-tex">\beta_j</annotation></semantics></math>
</li>
<li>Standard (unadjusted) counterparts for comparison arising from <code>lm(y~x)</code>
</li>
</ul>
</li>
</ol>
<p>Unlike the standard output arising from `lm(y~x), the selective p-values, confidence intervals, and points estimates are valid <em>conditional on rejection of the overall null hypothesis.</em></p>
<p>A tutorial for how to use this function in the vignettes section of the FScreen website <a href="https://mcgougho.github.io/lmFScreen/"><img src="https://img.shields.io/badge/docs-pkgdown-blue.svg" alt="pkgdown"></a>: <a href="articles/lmFScreen.html">Using lmFScreen</a></p>
<hr>
</div>
<div class="section level2">
<h2 id="retrospective-inference-with-psel_retro-function">Retrospective inference with <code>psel_retro</code> function<a class="anchor" aria-label="anchor" href="#retrospective-inference-with-psel_retro-function"></a>
</h2>
<p>The <code><a href="reference/psel_retro.html">psel_retro()</a></code> function allows for valid selective p-values in retrospective settings, where only the output of <code>summary(lm(y~x))</code> (not the raw data <code>x</code> and <code>y</code>) are available. It requires: 1. Sample size n 2. Number of predictors p 3. R-squared (i.e <code>summary(lm(y~x))$r.squared</code>) 4. Residual standard error (RSE) (i.e. <code>summary(lm(y~x))$sigma</code>) 5. F-statistic for the coefficient of interest (i.e. <code>summary(lm(y~x))$coefficients[j, "t value"]</code>, where <code>j-1</code> is the index of the coefficient of interest)</p>
<p>This is particularly useful when analyzing published results (e.g., from an applied paper’s Table 1) where individual-level data is unavailable.</p>
<p>A tutorial for how to use thsi function is in vignettes section of the FScreen website <a href="https://mcgougho.github.io/lmFScreen/"><img src="https://img.shields.io/badge/docs-pkgdown-blue.svg" alt="pkgdown"></a>: <a href="articles/psel_retro.html">Using psel_retro</a></p>
<hr>
</div>

  </main><aside class="col-md-3"><div class="links">
<h2 data-toc-skip>Links</h2>
<ul class="list-unstyled">
<li><a href="https://github.com/mcgougho/lmFScreen" class="external-link">GitHub</a></li>
</ul>
</div>

<div class="license">
<h2 data-toc-skip>License</h2>
<ul class="list-unstyled">
<li><a href="https://www.r-project.org/Licenses/GPL-3" class="external-link">GPL-3</a></li>
</ul>
</div>


<div class="citation">
<h2 data-toc-skip>Citation</h2>
<ul class="list-unstyled">
<li><a href="authors.html#citation">Citing lmFScreen</a></li>
</ul>
</div>

<div class="developers">
<h2 data-toc-skip>Developers</h2>
<ul class="list-unstyled">
<li>Olivia McGough <br><small class="roles"> Maintainer </small>  </li>
</ul>
</div>



  </aside>
</div>


    <footer><div class="pkgdown-footer-left">
  <p>Developed by Olivia McGough.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.1.</p>
</div>

    </footer>
</div>





  </body>
</html>
