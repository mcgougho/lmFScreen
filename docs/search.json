[{"path":"https://mcgougho.github.io/lmFScreen/articles/lmFScreen.html","id":"introduction","dir":"Articles","previous_headings":"","what":"Introduction","title":"Selective inference across NHANES cycles: lmFScreen example","text":"analysis use lmFScreen package compare femur neck bone mineral density (BMD) across National Health Nutrition Examination Survey (NHANES) cycles men age 30. NHANES biennial survey reports series health metrics large sample people United States. conduct analysis, first perform F-test “overall hypothesis change BMD across cycles. overall null hypothesis rejected, subsequently conduct post hoc tests individual coefficients correspond year/cycle data. adjust fact conducted post-hoc tests rejected overall null hypothesis.","code":""},{"path":"https://mcgougho.github.io/lmFScreen/articles/lmFScreen.html","id":"load-required-libraries","dir":"Articles","previous_headings":"","what":"Load Required Libraries","title":"Selective inference across NHANES cycles: lmFScreen example","text":"","code":"library(haven)    # For reading NHANES XPT files library(dplyr)    # For data manipulation library(lmFScreen) # For selective inference via F-screening"},{"path":"https://mcgougho.github.io/lmFScreen/articles/lmFScreen.html","id":"load-and-merge-nhanes-data","dir":"Articles","previous_headings":"","what":"Load and Merge NHANES Data","title":"Selective inference across NHANES cycles: lmFScreen example","text":"load BMD demographic data four NHANES cycles merge participant ID (SEQN).","code":"read_nhanes_cycle <- function(year) {   BMD <- read_xpt(paste0(\"DXXFEM_\", year, \".xpt\"))   DEMO <- read_xpt(paste0(\"DEMO_\", year, \".xpt\"))   merge(BMD, DEMO, by = \"SEQN\") }  merged_2005_2006 <- read_nhanes_cycle(\"2005_2006\") merged_2007_2008 <- read_nhanes_cycle(\"2007_2008\") merged_2009_2010 <- read_nhanes_cycle(\"2009_2010\") merged_2013_2014 <- read_nhanes_cycle(\"2013_2014\")"},{"path":"https://mcgougho.github.io/lmFScreen/articles/lmFScreen.html","id":"clean-and-prepare-data","dir":"Articles","previous_headings":"","what":"Clean and Prepare Data","title":"Selective inference across NHANES cycles: lmFScreen example","text":"retain age, gender, femur neck BMD, rename columns, remove missing values, restrict men older 30.","code":"prep_bmd_data <- function(df) {   df <- df[, c(\"RIDAGEYR\", \"DXXNKBMD\", \"RIAGENDR\")]   colnames(df) <- c(\"Age\", \"Femur_Neck_BMD\", \"Gender\")   df <- na.omit(df)   df %>% filter(Age > 30) }  bmd_men <- bind_rows(   prep_bmd_data(merged_2005_2006) %>% filter(Gender == 1) %>% mutate(Year = \"2005-2006\"),   prep_bmd_data(merged_2007_2008) %>% filter(Gender == 1) %>% mutate(Year = \"2007-2008\"),   prep_bmd_data(merged_2009_2010) %>% filter(Gender == 1) %>% mutate(Year = \"2009-2010\"),   prep_bmd_data(merged_2013_2014) %>% filter(Gender == 1) %>% mutate(Year = \"2013-2014\") )"},{"path":"https://mcgougho.github.io/lmFScreen/articles/lmFScreen.html","id":"construct-design-matrix","dir":"Articles","previous_headings":"","what":"Construct Design Matrix","title":"Selective inference across NHANES cycles: lmFScreen example","text":"create indicator variables NHANES cycle.","code":"bmd_men <- bmd_men %>% mutate(   Year = factor(Year, levels = c(\"2005-2006\", \"2007-2008\", \"2009-2010\", \"2013-2014\")),   Year_2005_2006 = as.integer(Year == \"2005-2006\"),   Year_2007_2008 = as.integer(Year == \"2007-2008\"),   Year_2009_2010 = as.integer(Year == \"2009-2010\"),   Year_2013_2014 = as.integer(Year == \"2013-2014\") )"},{"path":"https://mcgougho.github.io/lmFScreen/articles/lmFScreen.html","id":"conduct-overall-f-test","dir":"Articles","previous_headings":"","what":"Conduct overall F-test","title":"Selective inference across NHANES cycles: lmFScreen example","text":"run overall F-test check significant differences BMD across years. overall F-statistic significant, proceed inference individual coefficients year/cycle.","code":"model <- lm(Femur_Neck_BMD ~ Year + Age, data = bmd_men) summary(model) ##  ## Call: ## lm(formula = Femur_Neck_BMD ~ Year + Age, data = bmd_men) ##  ## Residuals: ##      Min       1Q   Median       3Q      Max  ## -0.37743 -0.09450 -0.00985  0.07919  0.70088  ##  ## Coefficients: ##                Estimate Std. Error t value Pr(>|t|)     ## (Intercept)    1.039434   0.007076 146.891  < 2e-16 *** ## Year2007-2008 -0.003687   0.004599  -0.802    0.423     ## Year2009-2010 -0.003280   0.004567  -0.718    0.473     ## Year2013-2014 -0.019821   0.004900  -4.045 5.29e-05 *** ## Age           -0.003448   0.000112 -30.801  < 2e-16 *** ## --- ## Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1 ##  ## Residual standard error: 0.1349 on 7130 degrees of freedom ## Multiple R-squared:  0.1235, Adjusted R-squared:  0.123  ## F-statistic: 251.1 on 4 and 7130 DF,  p-value: < 2.2e-16"},{"path":"https://mcgougho.github.io/lmFScreen/articles/lmFScreen.html","id":"prepare-for-pairwise-year-comparisons","dir":"Articles","previous_headings":"","what":"Prepare for Pairwise Year Comparisons","title":"Selective inference across NHANES cycles: lmFScreen example","text":"now define function : Constructs contrast Projects age intercept Runs lmFScreen.fit resulting matrix, conducts inference individual coefficients year model accounting overall F-test.","code":"do_year_comparison <- function(X, test_col, seed_val) {   set.seed(seed_val)   n <- nrow(X)   Y <- bmd_men$Femur_Neck_BMD   project_out <- cbind(bmd_men$Age)   svdP <- svd(project_out, nu = nrow(project_out))   U_perp <- svdP$u[, (sum(svdP$d > .Machine$double.eps) + 1):ncol(svdP$u)]   X <- t(U_perp) %*% X   Y <- t(U_perp) %*% Y   result <- lmFScreen.fit(X, Y, test_cols = test_col, alpha = 0.05, alpha_ov = 0.05)   summary(result) } do_year_comparison <- function(X, test_col, seed_val) {   set.seed(seed_val)   n <- nrow(X)   Y <- bmd_men$Femur_Neck_BMD   project_out <- cbind(bmd_men$Age, 1)   svdP <- svd(project_out, nu = nrow(project_out))   U_perp <- svdP$u[, (sum(svdP$d > .Machine$double.eps) + 1):ncol(svdP$u)]   X <- t(U_perp) %*% X   Y <- t(U_perp) %*% Y   result <- lmFScreen(Y~X+0, test_cols = test_col, alpha = 0.05, alpha_ov = 0.05)   summary(result) }"},{"path":"https://mcgougho.github.io/lmFScreen/articles/lmFScreen.html","id":"run-pairwise-year-comparisons","dir":"Articles","previous_headings":"","what":"Run Pairwise Year Comparisons","title":"Selective inference across NHANES cycles: lmFScreen example","text":"","code":"# Compare 2005-2006 vs 2007-2008 do_year_comparison(X=cbind(bmd_men$Year_2005_2006 + bmd_men$Year_2007_2008,                            bmd_men$Year_2007_2008, bmd_men$Year_2009_2010),                    test_col = 2, seed_val = 5678) ## lmFScreen Model Summary  ## -------------------------------------- ## Overall F-statistic:     6.8067 ## -------------------------------------- ##  ## Number of post hoc tests: 1 ## -------------------------------------- ##  ## Selective Estimates: ## Predictor       Estimate     Lower.CI    Upper.CI    P-value ## ------------------------------------------------------------- ##  X2            -0.003686     -0.0127      0.0053      0.4225 ##  ## Standard Estimates: ## Predictor       Estimate     Lower.CI    Upper.CI    P-value ## ------------------------------------------------------------- ##  X2            -0.003686     -0.0127      0.0053      0.4228 ##  ##  ## Significance levels: * < 0.05  ** < 0.01  *** < 0.001 # Compare 2005-2006 vs 2009-2010 do_year_comparison(X=cbind(bmd_men$Year_2005_2006 + bmd_men$Year_2009_2010,                            bmd_men$Year_2007_2008, bmd_men$Year_2009_2010),                    test_col = 3, seed_val = 56910) ## lmFScreen Model Summary  ## -------------------------------------- ## Overall F-statistic:     6.8067 ## -------------------------------------- ##  ## Number of post hoc tests: 1 ## -------------------------------------- ##  ## Selective Estimates: ## Predictor       Estimate     Lower.CI    Upper.CI    P-value ## ------------------------------------------------------------- ##  X3            -0.003280     -0.0123      0.0057      0.4731 ##  ## Standard Estimates: ## Predictor       Estimate     Lower.CI    Upper.CI    P-value ## ------------------------------------------------------------- ##  X3            -0.003280     -0.0122      0.0057      0.4727 ##  ##  ## Significance levels: * < 0.05  ** < 0.01  *** < 0.001 # Compare 2005-2006 vs 2013-2014 do_year_comparison(X=cbind(bmd_men$Year_2005_2006 + bmd_men$Year_2013_2014,                            bmd_men$Year_2009_2010,                             bmd_men$Year_2013_2014),                    test_col = 3, seed_val = 561314) ## lmFScreen Model Summary  ## -------------------------------------- ## Overall F-statistic:     6.8067 ## -------------------------------------- ##  ## Number of post hoc tests: 1 ## -------------------------------------- ##  ## Selective Estimates: ## Predictor       Estimate     Lower.CI    Upper.CI    P-value ## ------------------------------------------------------------- ##  X3            -0.018638     -0.0294     -0.0105      0.0010** ##  ## Standard Estimates: ## Predictor       Estimate     Lower.CI    Upper.CI    P-value ## ------------------------------------------------------------- ##  X3            -0.019821     -0.0294     -0.0102      0.0001*** ##  ##  ## Significance levels: * < 0.05  ** < 0.01  *** < 0.001 # Compare 2007-2008 vs 2009-2010 do_year_comparison(X=cbind(bmd_men$Year_2005_2006,                            bmd_men$Year_2007_2008+bmd_men$Year_2009_2010,                            bmd_men$Year_2009_2010),                    test_col = 3, seed_val = 78910) ## lmFScreen Model Summary  ## -------------------------------------- ## Overall F-statistic:     6.8067 ## -------------------------------------- ##  ## Number of post hoc tests: 1 ## -------------------------------------- ##  ## Selective Estimates: ## Predictor       Estimate     Lower.CI    Upper.CI    P-value ## ------------------------------------------------------------- ##  X3             0.000407     -0.0079      0.0087      0.9227 ##  ## Standard Estimates: ## Predictor       Estimate     Lower.CI    Upper.CI    P-value ## ------------------------------------------------------------- ##  X3             0.000407     -0.0079      0.0087      0.9233 ##  ##  ## Significance levels: * < 0.05  ** < 0.01  *** < 0.001 # Compare 2007-2008 vs 2013-2014 do_year_comparison(X=cbind(bmd_men$Year_2009_2010,                            bmd_men$Year_2007_2008+bmd_men$Year_2013_2014,                            bmd_men$Year_2013_2014),                    test_col = 3, seed_val = 781314) ## lmFScreen Model Summary  ## -------------------------------------- ## Overall F-statistic:     6.8067 ## -------------------------------------- ##  ## Number of post hoc tests: 1 ## -------------------------------------- ##  ## Selective Estimates: ## Predictor       Estimate     Lower.CI    Upper.CI    P-value ## ------------------------------------------------------------- ##  X3            -0.016130     -0.0251     -0.0071      0.0004*** ##  ## Standard Estimates: ## Predictor       Estimate     Lower.CI    Upper.CI    P-value ## ------------------------------------------------------------- ##  X3            -0.016134     -0.0251     -0.0072      0.0004*** ##  ##  ## Significance levels: * < 0.05  ** < 0.01  *** < 0.001 # Compare 2009-2010 vs 2013-2014 do_year_comparison(X=cbind(bmd_men$Year_2005_2006,                            bmd_men$Year_2009_2010+bmd_men$Year_2013_2014,                            bmd_men$Year_2013_2014),                    test_col = 3, seed_val = 9101314) ## lmFScreen Model Summary  ## -------------------------------------- ## Overall F-statistic:     6.8067 ## -------------------------------------- ##  ## Number of post hoc tests: 1 ## -------------------------------------- ##  ## Selective Estimates: ## Predictor       Estimate     Lower.CI    Upper.CI    P-value ## ------------------------------------------------------------- ##  X3            -0.016300     -0.0255     -0.0085      0.0006*** ##  ## Standard Estimates: ## Predictor       Estimate     Lower.CI    Upper.CI    P-value ## ------------------------------------------------------------- ##  X3            -0.016541     -0.0255     -0.0076      0.0003*** ##  ##  ## Significance levels: * < 0.05  ** < 0.01  *** < 0.001"},{"path":"https://mcgougho.github.io/lmFScreen/articles/lmFScreen.html","id":"interpretation","dir":"Articles","previous_headings":"","what":"Interpretation","title":"Selective inference across NHANES cycles: lmFScreen example","text":"selective p-values, point estimates, intervals valid conditional rejecting overall null hypothesis, contrast standard (naive) linear regression output. However, particular case, selective p-values, estimates, confidence intervals tend coincide standard counterparts, indicating selection (.e. face post hoc tests conducted conditional rejecing overall null hypothesos) large impact analysis.","code":""},{"path":"https://mcgougho.github.io/lmFScreen/articles/psel_retro.html","id":"ces-d-analysis","dir":"Articles","previous_headings":"","what":"CES-D Analysis","title":"Selective inference across age groups: psel_retro Example","text":"","code":"set.seed(826) means <- c(9.33, 7.60, 8.79) sds <- c(7.16, 5.84, 5.68) ns <- c(150, 449, 227) n <- sum(ns); p <- 3 overall_mean <- sum(means * ns) / sum(ns) r_squared <- sum(ns * (means - overall_mean)^2) / (sum(ns * (means - overall_mean)^2) + sum((ns - 1) * sds^2)) mse <- sum((ns - 1) * sds^2) / (n - p) rse <- sqrt(mse) df_within <- n - p  results_1_2 <- calculate_t_and_p(means[1], means[2], ns[1], ns[2], mse, df_within) results_1_3 <- calculate_t_and_p(means[1], means[3], ns[1], ns[3], mse, df_within) results_2_3 <- calculate_t_and_p(means[2], means[3], ns[2], ns[3], mse, df_within)  cat(\"\\nCES-D Naive p-values (with Sidak correction):\\n\") ##  ## CES-D Naive p-values (with Sidak correction): cat(\"<65 vs 65–84: p =\", results_1_2$p_val, \", sidak =\", results_1_2$sidak, \"\\n\") ## <65 vs 65–84: p = 0.00254 , sidak = 0.007600662 cat(\"<65 vs ≥85: p =\", results_1_3$p_val, \", sidak =\", results_1_3$sidak, \"\\n\") ## <65 vs ≥85: p = 0.3972102 , sidak = 0.780973 cat(\"65–84 vs ≥85: p =\", results_2_3$p_val, \", sidak =\", results_2_3$sidak, \"\\n\") ## 65–84 vs ≥85: p = 0.01609221 , sidak = 0.04750392 cat(\"\\nCES-D Selective p-values:\\n\") ##  ## CES-D Selective p-values: cat(\"<65 vs 65–84:\", psel_retro(n, p, r_squared, rse, (results_1_2$t_stat)), \"\\n\") ## <65 vs 65–84: 0.1165976 cat(\"<65 vs ≥85:\", psel_retro(n, p, r_squared, rse, (results_1_3$t_stat)), \"\\n\") ## <65 vs ≥85: 0.397351 cat(\"65–84 vs ≥85:\", psel_retro(n, p, r_squared, rse, (results_2_3$t_stat)), \"\\n\") ## 65–84 vs ≥85: 0.09905023"},{"path":"https://mcgougho.github.io/lmFScreen/articles/psel_retro.html","id":"sleep-analysis","dir":"Articles","previous_headings":"","what":"Sleep Analysis","title":"Selective inference across age groups: psel_retro Example","text":"","code":"set.seed(826) means <- c(6.65, 6.93, 7.07) sds <- c(0.87, 0.87, 1.02) ns <- c(150, 449, 227) n <- sum(ns); p <- 3 overall_mean <- sum(means * ns) / sum(ns) r_squared <- sum(ns * (means - overall_mean)^2) / (sum(ns * (means - overall_mean)^2) + sum((ns - 1) * sds^2)) mse <- sum((ns - 1) * sds^2) / (n - p) rse <- sqrt(mse) df_within <- n - p  results_1_2 <- calculate_t_and_p(means[1], means[2], ns[1], ns[2], mse, df_within) results_1_3 <- calculate_t_and_p(means[1], means[3], ns[1], ns[3], mse, df_within) results_2_3 <- calculate_t_and_p(means[2], means[3], ns[2], ns[3], mse, df_within)  cat(\"\\nSleep Naive p-values (with Sidak correction):\\n\") ##  ## Sleep Naive p-values (with Sidak correction): cat(\"<65 vs 65–84: p =\", results_1_2$p_val, \", sidak =\", results_1_2$sidak, \"\\n\") ## <65 vs 65–84: p = 0.001202429 , sidak = 0.00360295 cat(\"<65 vs ≥85: p =\", results_1_3$p_val, \", sidak =\", results_1_3$sidak, \"\\n\") ## <65 vs ≥85: p = 1.409129e-05 , sidak = 4.227326e-05 cat(\"65–84 vs ≥85: p =\", results_2_3$p_val, \", sidak =\", results_2_3$sidak, \"\\n\") ## 65–84 vs ≥85: p = 0.06025183 , sidak = 0.1700834 cat(\"\\nSleep Selective p-values:\\n\") ##  ## Sleep Selective p-values: cat(\"<65 vs 65–84:\", psel_retro(n, p, r_squared, rse, (results_1_2$t_stat)), \"\\n\") ## <65 vs 65–84: 0.001254953 cat(\"<65 vs ≥85:\", psel_retro(n, p, r_squared, rse, (results_1_3$t_stat)), \"\\n\") ## <65 vs ≥85: 0.00284495 cat(\"65–84 vs ≥85:\", psel_retro(n, p, r_squared, rse, (results_2_3$t_stat)), \"\\n\") ## 65–84 vs ≥85: 0.06058"},{"path":"https://mcgougho.github.io/lmFScreen/articles/psel_retro.html","id":"mmses-analysis","dir":"Articles","previous_headings":"","what":"MMSES Analysis","title":"Selective inference across age groups: psel_retro Example","text":"","code":"set.seed(826) means <- c(29.31, 28.12, 26.14) sds <- c(1.19, 2.42, 4.15) ns <- c(150, 449, 227) n <- sum(ns); p <- 3 overall_mean <- sum(means * ns) / sum(ns) r_squared <- sum(ns * (means - overall_mean)^2) / (sum(ns * (means - overall_mean)^2) + sum((ns - 1) * sds^2)) mse <- sum((ns - 1) * sds^2) / (n - p) rse <- sqrt(mse) df_within <- n - p  results_1_2 <- calculate_t_and_p(means[1], means[2], ns[1], ns[2], mse, df_within) results_1_3 <- calculate_t_and_p(means[1], means[3], ns[1], ns[3], mse, df_within) results_2_3 <- calculate_t_and_p(means[2], means[3], ns[2], ns[3], mse, df_within)  cat(\"\\nMMSES Naive p-values (with Sidak correction):\\n\") ##  ## MMSES Naive p-values (with Sidak correction): cat(\"<65 vs 65–84: p =\", results_1_2$p_val, \", sidak =\", results_1_2$sidak, \"\\n\") ## <65 vs 65–84: p = 1.151974e-05 , sidak = 3.455883e-05 cat(\"<65 vs ≥85: p =\", results_1_3$p_val, \", sidak =\", results_1_3$sidak, \"\\n\") ## <65 vs ≥85: p = 1.925529e-24 , sidak = 0 cat(\"65–84 vs ≥85: p =\", results_2_3$p_val, \", sidak =\", results_2_3$sidak, \"\\n\") ## 65–84 vs ≥85: p = 8.577183e-17 , sidak = 3.330669e-16 cat(\"\\nMMSES Selective p-values:\\n\") ##  ## MMSES Selective p-values: cat(\"<65 vs 65–84:\", psel_retro(n, p, r_squared, rse, results_1_2$t_stat), \"\\n\") ## <65 vs 65–84: 9e-06 cat(\"<65 vs ≥85:\", psel_retro(n, p, r_squared, rse, results_1_3$t_stat), \"\\n\") ## <65 vs ≥85: 0 cat(\"65–84 vs ≥85:\", psel_retro(n, p, r_squared, rse, results_2_3$t_stat), \"\\n\") ## 65–84 vs ≥85: 0"},{"path":"https://mcgougho.github.io/lmFScreen/articles/psel_retro.html","id":"mdrs-analysis","dir":"Articles","previous_headings":"","what":"MDRS Analysis","title":"Selective inference across age groups: psel_retro Example","text":"","code":"set.seed(826) means <- c(141.5, 139.0, 131.6) sds <- c(2.57, 5.85, 14.89) ns <- c(150, 449, 227) n <- sum(ns); p <- 3 overall_mean <- sum(means * ns) / sum(ns) r_squared <- sum(ns * (means - overall_mean)^2) / (sum(ns * (means - overall_mean)^2) + sum((ns - 1) * sds^2)) mse <- sum((ns - 1) * sds^2) / (n - p) rse <- sqrt(mse) df_within <- n - p  results_1_2 <- calculate_t_and_p(means[1], means[2], ns[1], ns[2], mse, df_within) results_1_3 <- calculate_t_and_p(means[1], means[3], ns[1], ns[3], mse, df_within) results_2_3 <- calculate_t_and_p(means[2], means[3], ns[2], ns[3], mse, df_within)  cat(\"\\nMDRS Naive p-values (with Sidak correction):\\n\") ##  ## MDRS Naive p-values (with Sidak correction): cat(\"<65 vs 65–84: p =\", results_1_2$p_val, \", sidak =\", results_1_2$sidak, \"\\n\") ## <65 vs 65–84: p = 0.00325966 , sidak = 0.009747137 cat(\"<65 vs ≥85: p =\", results_1_3$p_val, \", sidak =\", results_1_3$sidak, \"\\n\") ## <65 vs ≥85: p = 3.523733e-24 , sidak = 0 cat(\"65–84 vs ≥85: p =\", results_2_3$p_val, \", sidak =\", results_2_3$sidak, \"\\n\") ## 65–84 vs ≥85: p = 9.552161e-23 , sidak = 0 cat(\"\\nMDRS Selective p-values:\\n\") ##  ## MDRS Selective p-values: cat(\"<65 vs 65–84:\", psel_retro(n, p, r_squared, rse, results_1_2$t_stat), \"\\n\") ## <65 vs 65–84: 0.003283 cat(\"<65 vs ≥85:\", psel_retro(n, p, r_squared, rse, results_1_3$t_stat), \"\\n\") ## <65 vs ≥85: 0 cat(\"65–84 vs ≥85:\", psel_retro(n, p, r_squared, rse, results_2_3$t_stat), \"\\n\") ## 65–84 vs ≥85: 0"},{"path":"https://mcgougho.github.io/lmFScreen/articles/psel_retro.html","id":"summary","dir":"Articles","previous_headings":"","what":"Summary","title":"Selective inference across age groups: psel_retro Example","text":"analysis, revisited pairwise comparisons across age groups four outcomes reported JAMA Network Open paper “Longitudinal Sleep Patterns Cognitive Impairment Older Adults”, accounting fact pairwise comparisons conducted overall null hypothesis difference across age groups conducted. selective p-values differ meaningfully standard/naive counterparts (case CES-D outcome), others remain similar. Sidak-corrected p-values reported original paper align Sidak-corrected naive p-values shown . conditioning rejection overall null hypothesis, selective p-values provide principled post-hoc analysis guarding inflated Type error.","code":""},{"path":"https://mcgougho.github.io/lmFScreen/authors.html","id":null,"dir":"","previous_headings":"","what":"Authors","title":"Authors and Citation","text":"Olivia McGough. Maintainer.","code":""},{"path":"https://mcgougho.github.io/lmFScreen/authors.html","id":"citation","dir":"","previous_headings":"","what":"Citation","title":"Authors and Citation","text":"McGough O (2025). lmFScreen: Selective Inference Linear Regression F-Screening. R package version 0.1.1, https://mcgougho.github.io/lmFScreen.","code":"@Manual{,   title = {lmFScreen: Selective Inference for Linear Regression with F-Screening},   author = {Olivia McGough},   year = {2025},   note = {R package version 0.1.1},   url = {https://mcgougho.github.io/lmFScreen}, }"},{"path":"https://mcgougho.github.io/lmFScreen/index.html","id":"what-is-f-screening","dir":"","previous_headings":"","what":"What is F-screening?","title":"lmFScreen","text":"Suppose nn-vector YY containing quantitative response nn observations n×pn\\times p design matrix XX containing pp covariates/features nn observations. interest lies linear model Y=Xβ+ϵY = X\\beta +\\epsilon. common data analysis pipeline, refer “F-screening,” follows: Test “overall” null hypothesis, H0:β1=β2=...=βp=0,H_0: \\beta_1 = \\beta_2 = ... = \\beta_p = 0, using F-test. () test rejected, conduct inference βj\\beta_j coefficient jj. Typically, Steps 1 2 carried using, e.g., command lm(Y~X). (However, explained next paragraph, analysis pipeline problematic.) F-screening intuitive widely used, carrying Step 2 using “standard” approach – instance, testing H0j:βj=0H_{0}^j: \\beta_j=0 using t-test output lm(Y~X) – problematic, account fact conduct inference βj\\beta_jonly rejected “overall” null hypothesis Step 1. Consequently, standard t-test H0j:βj=0H_{0}^j: \\beta_j=0 control Type 1 error, standard confidence intervals βj\\beta_j attain nominal coverage, even point estimate βj\\beta_j output lm(Y~X) biased. lmFScreen package provides valid inferential toolbox conducting Step 2 F-screening procedure, accounting fact conduct inference βj\\beta_j Step 2 reject overall null hypothesis Step 1. inferential toolbox falls larger umbrella “conditional selective inference”, “selection event” conditioning rejection overall null hypothesis Step 1. package based 2025 paper “Valid F-screening linear regression” McGough, Witten, Kessler (arxiv preprint: https://arxiv.org/abs/2505.23113). See https://github.com/mcgougho/lmFScreen-paper code replicate figures paper.","code":""},{"path":"https://mcgougho.github.io/lmFScreen/index.html","id":"installation","dir":"","previous_headings":"","what":"Installation","title":"lmFScreen","text":"install lmFScreen package GitHub, run following R console: devtools::install_github(\"mcgougho/lmFScreen\").","code":""},{"path":"https://mcgougho.github.io/lmFScreen/index.html","id":"prospective-inference-with-lmfscreen-function","dir":"","previous_headings":"","what":"Prospective inference with lmFScreen function","title":"lmFScreen","text":"lmFScreen function enables valid inference conditional rejection overall F-test linear regression, using tools conditional selective inference. Given design matrix X response vector y, package: Conducts F-test overall null hypothesis H0:β1=β2=...=βp=0H_0: \\beta_1 = \\beta_2 = ... = \\beta_p = 0 using lm(y~X). overall test rejected, conducts inference specified coefficients (test_cols). Selective p-values H0j:βj=0H_0^j:\\beta_j=0 Selective confidence intervals βj\\beta_j Selective point estimates βj\\beta_j Standard (unadjusted) counterparts comparison arising lm(y~x) overall test rejected, function returns overall F-statistic p-value. Unlike standard output arising lm(y~X), selective p-values, confidence intervals, points estimates valid conditional rejection overall null hypothesis. tutorial use function can found FScreen website  Using lmFScreen tab.","code":""},{"path":"https://mcgougho.github.io/lmFScreen/index.html","id":"retrospective-inference-with-psel_retro-function","dir":"","previous_headings":"","what":"Retrospective inference with psel_retro function","title":"lmFScreen","text":"psel_retro() function allows valid selective p-values retrospective settings, output summary(lm(y~x)) (raw data x y) available. requires: Sample size n Number predictors p R-squared (.e summary(lm(y~x))$r.squared) overall linear model Residual standard error (RSE) (.e. can obtained squaring summary(lm(y~x))$sigma) overall linear model F-statistic coefficient interest (.e. summary(lm(y~x))$coefficients[j, \"t value\"], j-1 index coefficient interest) particularly useful analyzing published results (e.g., applied paper’s Table 1) individual-level data unavailable. tutorial use function can found FScreen website  Using psel_retro tab.","code":""},{"path":"https://mcgougho.github.io/lmFScreen/reference/coef.lmFScreen.html","id":null,"dir":"Reference","previous_headings":"","what":"Extract Coefficients from an lmFScreen Model — coef.lmFScreen","title":"Extract Coefficients from an lmFScreen Model — coef.lmFScreen","text":"S3 method prints returns selective naive coefficient estimates lmFScreen model.","code":""},{"path":"https://mcgougho.github.io/lmFScreen/reference/coef.lmFScreen.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Extract Coefficients from an lmFScreen Model — coef.lmFScreen","text":"","code":"# S3 method for class 'lmFScreen' coef(object, ...)"},{"path":"https://mcgougho.github.io/lmFScreen/reference/coef.lmFScreen.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Extract Coefficients from an lmFScreen Model — coef.lmFScreen","text":"object object class lmFScreen. ... Currently unused.","code":""},{"path":"https://mcgougho.github.io/lmFScreen/reference/coef.lmFScreen.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Extract Coefficients from an lmFScreen Model — coef.lmFScreen","text":"Invisibly returns data frame containing: Predictor: Names predictor variables Estimate (Selective): Selective coefficient estimates Estimate (Naive): Naive coefficient estimates","code":""},{"path":"https://mcgougho.github.io/lmFScreen/reference/coef.lmFScreen.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Extract Coefficients from an lmFScreen Model — coef.lmFScreen","text":"","code":"data(mtcars) mod <- lmFScreen(mpg ~ wt + hp, data = mtcars) coef(mod) #>  #> Coefficients from lmFScreen #> ---------------------------- #>   Predictor Selective.Est   Naive.Est #> 1        wt   -3.87783074 -3.87783074 #> 2        hp   -0.03177295 -0.03177295"},{"path":"https://mcgougho.github.io/lmFScreen/reference/compute_MLE.html","id":null,"dir":"Reference","previous_headings":"","what":"Compute the Selective Maximum Likelihood Estimate for beta1 — compute_MLE","title":"Compute the Selective Maximum Likelihood Estimate for beta1 — compute_MLE","text":"function numerically approximates conditional maximum likelihood estimate (MLE) single regression coefficient using Monte Carlo approximation selective likelihood, conditional passing overall F-test.","code":""},{"path":"https://mcgougho.github.io/lmFScreen/reference/compute_MLE.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Compute the Selective Maximum Likelihood Estimate for beta1 — compute_MLE","text":"","code":"compute_MLE(X, y, sigma_sq, alpha_ov, interval = c(-10, 10), B = 1e+06)"},{"path":"https://mcgougho.github.io/lmFScreen/reference/compute_MLE.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Compute the Selective Maximum Likelihood Estimate for beta1 — compute_MLE","text":"X numeric matrix predictor variables (n x p), first column corresponding beta1. y numeric response vector length n. sigma_sq noise variance. unknown, estimated beforehand. alpha_ov significance level overall F-test (used defining selection region). interval numeric vector length 2 giving search interval beta1 (default: c(-10, 10)). B number Monte Carlo samples used approximate likelihood (default: 1e6).","code":""},{"path":"https://mcgougho.github.io/lmFScreen/reference/compute_MLE.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Compute the Selective Maximum Likelihood Estimate for beta1 — compute_MLE","text":"list containing: beta MLE beta1 (single coefficient) selective likelihood. max_likelihood maximum log-likelihood value achieved optimal beta1.","code":""},{"path":"https://mcgougho.github.io/lmFScreen/reference/compute_likelihood_function.html","id":null,"dir":"Reference","previous_headings":"","what":"Construct the Selective Log-Likelihood Function for beta1 — compute_likelihood_function","title":"Construct the Selective Log-Likelihood Function for beta1 — compute_likelihood_function","text":"function constructs log-likelihood function single regression coefficient (beta1), conditional selection via overall F-test. log-likelihood approximated using Monte Carlo integration.","code":""},{"path":"https://mcgougho.github.io/lmFScreen/reference/compute_likelihood_function.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Construct the Selective Log-Likelihood Function for beta1 — compute_likelihood_function","text":"","code":"compute_likelihood_function(X, y, sigma_sq, alpha_ov = 0.05, B = 1e+06)"},{"path":"https://mcgougho.github.io/lmFScreen/reference/compute_likelihood_function.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Construct the Selective Log-Likelihood Function for beta1 — compute_likelihood_function","text":"X numeric matrix predictors (n x p), beta1 corresponding first column. y numeric response vector length n. sigma_sq noise variance. alpha_ov significance level overall F-test (default: 0.05). B number Monte Carlo samples (default: 1e6).","code":""},{"path":"https://mcgougho.github.io/lmFScreen/reference/compute_likelihood_function.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Construct the Selective Log-Likelihood Function for beta1 — compute_likelihood_function","text":"function one argument beta1 returns approximate log-likelihood, conditional selection. observed data fails selection condition, function returns -Inf.","code":""},{"path":"https://mcgougho.github.io/lmFScreen/reference/confint.lmFScreen.html","id":null,"dir":"Reference","previous_headings":"","what":"Compute Confidence Intervals for an lmFScreen Model — confint.lmFScreen","title":"Compute Confidence Intervals for an lmFScreen Model — confint.lmFScreen","text":"Prints returns confidence intervals selective naive estimates. confidence level taken alpha value stored lmFScreen object.","code":""},{"path":"https://mcgougho.github.io/lmFScreen/reference/confint.lmFScreen.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Compute Confidence Intervals for an lmFScreen Model — confint.lmFScreen","text":"","code":"# S3 method for class 'lmFScreen' confint(object, ...)"},{"path":"https://mcgougho.github.io/lmFScreen/reference/confint.lmFScreen.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Compute Confidence Intervals for an lmFScreen Model — confint.lmFScreen","text":"object object class lmFScreen containing model results. ... Additional arguments (currently unused).","code":""},{"path":"https://mcgougho.github.io/lmFScreen/reference/confint.lmFScreen.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Compute Confidence Intervals for an lmFScreen Model — confint.lmFScreen","text":"Invisibly returns list containing: Selective: data frame confidence intervals selective estimates Standard: data frame confidence intervals standard estimates","code":""},{"path":"https://mcgougho.github.io/lmFScreen/reference/confint.lmFScreen.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Compute Confidence Intervals for an lmFScreen Model — confint.lmFScreen","text":"","code":"data(mtcars) result <- lmFScreen(mpg ~ wt + hp, data = mtcars) confint(result) #>  #> lmFScreen Model Confidence Intervals #> ------------------------------------------------------ #> Confidence Level: 95.00% #> Number of predictors: 2 #> ------------------------------------------------------ #>  #> Selective Confidence Intervals: #> Predictor       Lower.CI     Upper.CI #> --------------------------------------------- #>  wt                -5.1704       -2.5839 #>  hp                -0.0502       -0.0133 #>  #> Standard Confidence Intervals: #> Predictor       Lower.CI     Upper.CI #> --------------------------------------------- #>  wt                -5.1180       -2.6377 #>  hp                -0.0495       -0.0141 #>"},{"path":"https://mcgougho.github.io/lmFScreen/reference/get_CI.html","id":null,"dir":"Reference","previous_headings":"","what":"Compute a Selective Confidence Interval Using Root-Finding — get_CI","title":"Compute a Selective Confidence Interval Using Root-Finding — get_CI","text":"function computes selective confidence interval regression coefficient identifying values parameter selective p-value equals specified significance level.","code":""},{"path":"https://mcgougho.github.io/lmFScreen/reference/get_CI.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Compute a Selective Confidence Interval Using Root-Finding — get_CI","text":"","code":"get_CI(pselb, point_est, naive_se_est, alpha)"},{"path":"https://mcgougho.github.io/lmFScreen/reference/get_CI.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Compute a Selective Confidence Interval Using Root-Finding — get_CI","text":"pselb function returns selective p-value given value parameter. point_est point estimate parameter (typically selective MLE). naive_se_est naive standard error estimate. alpha significance level confidence interval (default 0.05).","code":""},{"path":"https://mcgougho.github.io/lmFScreen/reference/get_CI.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Compute a Selective Confidence Interval Using Root-Finding — get_CI","text":"numeric vector length 2 giving lower upper bounds selective confidence interval.","code":""},{"path":"https://mcgougho.github.io/lmFScreen/reference/get_CI.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"Compute a Selective Confidence Interval Using Root-Finding — get_CI","text":"function computes lower upper bounds confidence interval solving values parameter selective p-value equals significance level alpha. search performed using uniroot, finds roots function defined difference selective p-value alpha. function expands search range iteratively root initially found given interval. selective p-value point estimate less equal alpha, interval considered valid. , empty infinite interval may returned, warning printed.","code":""},{"path":"https://mcgougho.github.io/lmFScreen/reference/get_Xy_centered.html","id":null,"dir":"Reference","previous_headings":"","what":"Project Out the Intercept from X and y — get_Xy_centered","title":"Project Out the Intercept from X and y — get_Xy_centered","text":"function projects predictor matrix X response vector y onto orthogonal complement intercept (constant) vector. removes component data explained intercept, effectively centering data sense removing mean direction.","code":""},{"path":"https://mcgougho.github.io/lmFScreen/reference/get_Xy_centered.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Project Out the Intercept from X and y — get_Xy_centered","text":"","code":"get_Xy_centered(X, y)"},{"path":"https://mcgougho.github.io/lmFScreen/reference/get_Xy_centered.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Project Out the Intercept from X and y — get_Xy_centered","text":"X numeric matrix predictors dimensions (n x p). y numeric response vector length n.","code":""},{"path":"https://mcgougho.github.io/lmFScreen/reference/get_Xy_centered.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Project Out the Intercept from X and y — get_Xy_centered","text":"list containing: X predictor matrix projection (dimensions: (n - 1) x p). y response vector projection (length: n - 1).","code":""},{"path":"https://mcgougho.github.io/lmFScreen/reference/get_Xy_centered.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"Project Out the Intercept from X and y — get_Xy_centered","text":"function uses singular value decomposition (SVD) intercept vector construct orthonormal basis space orthogonal intercept. projects X y onto space, effectively removing contribution intercept.","code":""},{"path":"https://mcgougho.github.io/lmFScreen/reference/get_Xy_centered.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Project Out the Intercept from X and y — get_Xy_centered","text":"","code":"X <- matrix(rnorm(100), nrow = 10) y <- rnorm(10) centered_data <- lmFScreen:::get_Xy_centered(X, y) X_centered <- centered_data$X y_centered <- centered_data$y"},{"path":"https://mcgougho.github.io/lmFScreen/reference/get_pselb.html","id":null,"dir":"Reference","previous_headings":"","what":"Construct the Selective P-Value Function for a Single Coefficient — get_pselb","title":"Construct the Selective P-Value Function for a Single Coefficient — get_pselb","text":"function returns function computes selective p-value given value b (hypothesized value beta1), conditional rejection overall F-test. p-value estimated via Monte Carlo integration, accounting selection event.","code":""},{"path":"https://mcgougho.github.io/lmFScreen/reference/get_pselb.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Construct the Selective P-Value Function for a Single Coefficient — get_pselb","text":"","code":"get_pselb(   X,   y,   sigma_sq,   yPy = NULL,   rss = NULL,   alpha_ov = 0.05,   B = 10000,   min_select = B,   B_max = 1e+07,   verbose = FALSE )"},{"path":"https://mcgougho.github.io/lmFScreen/reference/get_pselb.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Construct the Selective P-Value Function for a Single Coefficient — get_pselb","text":"X numeric matrix predictors n rows p columns. first column corresponds coefficient interest. y numeric response vector length n. sigma_sq variance error term. Must specified advance. yPy Optional value quadratic form y' P_X y. NULL, computed internally. rss Optional residual sum squares. NULL, computed internally using y yPy. alpha_ov Significance level overall F-test. Default 0.05. B Number Monte Carlo samples drawn per iteration. Default 10,000. min_select Minimum number selected samples required estimate p-value. Default equal B. B_max Maximum number Monte Carlo samples drawn iteration. Default 10 million. verbose Logical flag indicating whether print progress messages sampling.","code":""},{"path":"https://mcgougho.github.io/lmFScreen/reference/get_pselb.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Construct the Selective P-Value Function for a Single Coefficient — get_pselb","text":"function takes numeric argument b returns selective p-value corresponding value beta1. selection condition met observed data, returned function always return NA.","code":""},{"path":"https://mcgougho.github.io/lmFScreen/reference/get_pselb.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"Construct the Selective P-Value Function for a Single Coefficient — get_pselb","text":"returned function estimates conditional probability test statistic T(b) exceeds observed value, given data passes F-test threshold. Sampling proceeds least min_select Monte Carlo draws satisfy selection condition. achieved within given sample limits, function returns NA.","code":""},{"path":"https://mcgougho.github.io/lmFScreen/reference/get_variance_estimate.html","id":null,"dir":"Reference","previous_headings":"","what":"Estimate Variance for Selective Inference — get_variance_estimate","title":"Estimate Variance for Selective Inference — get_variance_estimate","text":"Computes estimate error variance used selective inference, based rescaled residual sum squares linear regression model.","code":""},{"path":"https://mcgougho.github.io/lmFScreen/reference/get_variance_estimate.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Estimate Variance for Selective Inference — get_variance_estimate","text":"","code":"get_variance_estimate(X, Y, alpha_ov)"},{"path":"https://mcgougho.github.io/lmFScreen/reference/get_variance_estimate.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Estimate Variance for Selective Inference — get_variance_estimate","text":"X numeric matrix predictor variables n rows p columns. Y numeric response vector length n. alpha_ov significance level used overall F-test.","code":""},{"path":"https://mcgougho.github.io/lmFScreen/reference/get_variance_estimate.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Estimate Variance for Selective Inference — get_variance_estimate","text":"numeric value representing estimated variance used selective inference.","code":""},{"path":"https://mcgougho.github.io/lmFScreen/reference/get_variance_estimate.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"Estimate Variance for Selective Inference — get_variance_estimate","text":"function estimates variance error term assumption inference performed conditional rejection overall F-test.","code":""},{"path":"https://mcgougho.github.io/lmFScreen/reference/lmFScreen.fit.html","id":null,"dir":"Reference","previous_headings":"","what":"lmFScreen.fit: Valid F-screening — lmFScreen.fit","title":"lmFScreen.fit: Valid F-screening — lmFScreen.fit","text":"function takes input design matrix X output vector y fits linear regression model (without intercept – X y centered). conducts F-screening defined \"Valid F-screening linear regression\" testing overall hypothesis coefficients linear regression zero using F-test, overall test rejected, outputs selective p-values, confidence intervals, point estimates coefficients linear regression model condition rejection overall F-test. overall test rejected, returns overall F-statistic indicates significant.","code":""},{"path":"https://mcgougho.github.io/lmFScreen/reference/lmFScreen.fit.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"lmFScreen.fit: Valid F-screening — lmFScreen.fit","text":"","code":"lmFScreen.fit(   X,   y,   alpha = 0.05,   alpha_ov = 0.05,   test_cols = 1:ncol(X),   sigma_sq = NULL,   compute_CI = TRUE,   compute_est = TRUE,   B = 1e+05 )"},{"path":"https://mcgougho.github.io/lmFScreen/reference/lmFScreen.fit.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"lmFScreen.fit: Valid F-screening — lmFScreen.fit","text":"X numeric matrix predictors. y numeric response vector. alpha Significance level confidence intervals hypothesis tests (default: 0.05). alpha_ov Significance level overall F-test used screening (default: 0.05). test_cols Indices predictors test (default: columns X). sigma_sq Optional noise variance. NULL, estimated using corrected residual variance. compute_CI Logical; whether compute selective confidence intervals (default: TRUE). compute_est Logical; whether compute selective point estimates (default: TRUE). B Number Monte Carlo samples used selective inference (default: 100000).","code":""},{"path":"https://mcgougho.github.io/lmFScreen/reference/lmFScreen.fit.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"lmFScreen.fit: Valid F-screening — lmFScreen.fit","text":"list class lmFScreen containing: Selective coefficients, confidence intervals, p-values Standard (OLS) coefficients, confidence intervals, p-values Model settings: alpha alpha_ov","code":""},{"path":"https://mcgougho.github.io/lmFScreen/reference/lmFScreen.fit.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"lmFScreen.fit: Valid F-screening — lmFScreen.fit","text":"","code":"data(mtcars) X <- cbind(mtcars$wt, mtcars$hp) y <- mtcars$mpg svdP <- svd(rep(1,nrow(mtcars)), nu = nrow(mtcars)) tol <- nrow(mtcars) * max(svdP$d) * .Machine$double.eps r <- sum(svdP$d > tol) U_full <- svdP$u U_perp <- U_full[, (r+1):ncol(U_full)] X <- t(U_perp) %*% X y <- t(U_perp) %*% y result <- lmFScreen.fit(X,y) #> Error in lmFScreen.fit(X, y): could not find function \"lmFScreen.fit\" summary(result) #> Error: object 'result' not found coef(result) #> Error: object 'result' not found confint(result) #> Error: object 'result' not found"},{"path":"https://mcgougho.github.io/lmFScreen/reference/lmFScreen.html","id":null,"dir":"Reference","previous_headings":"","what":"lmFScreen: Valid F-screening — lmFScreen","title":"lmFScreen: Valid F-screening — lmFScreen","text":"function takes input design matrix X output vector y fits least squares linear regression model. intercept present model, data projected remove intercept conducting inference. conducts F-screening (via function lmFScreen.fit) defined 2025 paper \"Valid F-screening linear regression\" McGough, Witten, Kessler (arxiv preprint: https://arxiv.org/abs/2505.23113) follows: First, tests overall hypothesis coefficients (excluding intercept) linear regression zero using F-test. () overall test rejected, outputs selective p-values, confidence intervals, point estimates coefficients linear regression model condition rejection overall F-test. overall test rejected, function returns overall F-statistic p-value indicates significant.","code":""},{"path":"https://mcgougho.github.io/lmFScreen/reference/lmFScreen.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"lmFScreen: Valid F-screening — lmFScreen","text":"","code":"lmFScreen(   formula,   data,   alpha = 0.05,   alpha_ov = 0.05,   test_cols = 1:ncol(X),   sigma_sq = NULL,   compute_CI = TRUE,   compute_est = TRUE,   B = 1e+05 )"},{"path":"https://mcgougho.github.io/lmFScreen/reference/lmFScreen.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"lmFScreen: Valid F-screening — lmFScreen","text":"formula formula specifying linear model (e.g., y ~ x1 + x2). data optional data frame containing variables model. alpha Significance level confidence intervals hypothesis tests (default: 0.05). alpha_ov Significance level overall F-test used screening (default: 0.05). test_cols Indices predictors test (default: columns X). sigma_sq Optional noise variance. NULL, estimated using corrected residual variance. compute_CI Logical; whether compute selective confidence intervals (default: TRUE). compute_est Logical; whether compute selective point estimates (default: TRUE). B Number Monte Carlo samples used selective inference (default: 100000).","code":""},{"path":"https://mcgougho.github.io/lmFScreen/reference/lmFScreen.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"lmFScreen: Valid F-screening — lmFScreen","text":"object class lmFScreen, includes: Selective coefficients, confidence intervals, p-values Standard (unadjusted) estimates, confidence intervals, p-values Model-level settings alpha alpha_ov","code":""},{"path":"https://mcgougho.github.io/lmFScreen/reference/lmFScreen.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"lmFScreen: Valid F-screening — lmFScreen","text":"function performs following steps: Converts formula model matrix response vector. Projects intercept one included formula. Calls lmFScreen.fit compute selective inference results predictors test_cols.","code":""},{"path":"https://mcgougho.github.io/lmFScreen/reference/lmFScreen.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"lmFScreen: Valid F-screening — lmFScreen","text":"","code":"# EXAMPLE 1 data(mtcars) result <- lmFScreen(mpg ~ wt + hp, data = mtcars) summary(result) #> lmFScreen Model Summary  #> -------------------------------------- #> Overall F-statistic:    69.2112 #> -------------------------------------- #>  #> Number of post hoc tests: 2 #> -------------------------------------- #>  #> Selective Estimates: #> Predictor       Estimate     Lower.CI    Upper.CI    P-value #> ------------------------------------------------------------- #>  wt            -3.877831     -5.1727     -2.5851      0.0000*** #>  hp            -0.031773     -0.0502     -0.0133      0.0014** #>  #> Standard Estimates: #> Predictor       Estimate     Lower.CI    Upper.CI    P-value #> ------------------------------------------------------------- #>  wt            -3.877831     -5.1180     -2.6377      0.0000*** #>  hp            -0.031773     -0.0495     -0.0141      0.0015** #>  #>  #> Significance levels: * < 0.05  ** < 0.01  *** < 0.001 coef(result) #>  #> Coefficients from lmFScreen #> ---------------------------- #>   Predictor Selective.Est   Naive.Est #> 1        wt   -3.87783074 -3.87783074 #> 2        hp   -0.03177295 -0.03177295 confint(result) #>  #> lmFScreen Model Confidence Intervals #> ------------------------------------------------------ #> Confidence Level: 95.00% #> Number of predictors: 2 #> ------------------------------------------------------ #>  #> Selective Confidence Intervals: #> Predictor       Lower.CI     Upper.CI #> --------------------------------------------- #>  wt                -5.1727       -2.5851 #>  hp                -0.0502       -0.0133 #>  #> Standard Confidence Intervals: #> Predictor       Lower.CI     Upper.CI #> --------------------------------------------- #>  wt                -5.1180       -2.6377 #>  hp                -0.0495       -0.0141 #>  # in example 1 the overall F-test has a p-value close to zero, so there is essentially no need to account for selection  # EXAMPLE 2 set.seed(50) X <- matrix(rnorm(100), ncol = 5) y <- rnorm(20) result <- lmFScreen(y ~ X) #> Did not pass Fscreening! #> overall F-statistic:  0.8874302  on  5  and  14  degrees of freedom #> p-value:  0.6090876  # in example 2, the overall F-test is not rejected  # EXAMPLE 3 set.seed(100) X <- matrix(rnorm(100), ncol = 5) beta <- c(.5,.4,.3,.2,.1) y <- X %*% beta + rnorm(20) result <- lmFScreen(y ~ X) summary(result) #> lmFScreen Model Summary  #> -------------------------------------- #> Overall F-statistic:     4.2599 #> -------------------------------------- #>  #> Number of post hoc tests: 5 #> -------------------------------------- #>  #> Selective Estimates: #> Predictor       Estimate     Lower.CI    Upper.CI    P-value #> ------------------------------------------------------------- #>  X1             0.415839     -0.2833      1.3457      0.2362 #>  X2             0.532707     -0.1291      1.4702      0.1178 #>  X3             0.188660     -0.2351      0.7115      0.3690 #>  X4             0.034547     -0.5122      0.6010      0.8900 #>  X5             0.133741     -0.3295      0.6239      0.5835 #>  #> Standard Estimates: #> Predictor       Estimate     Lower.CI    Upper.CI    P-value #> ------------------------------------------------------------- #>  X1             0.629408     -0.0184      1.2772      0.0776 #>  X2             0.823721      0.2247      1.4228      0.0174* #>  X3             0.277856     -0.1075      0.6633      0.1795 #>  X4             0.050258     -0.4140      0.5145      0.8350 #>  X5             0.170696     -0.2236      0.5650      0.4104 #>  #>  #> Significance levels: * < 0.05  ** < 0.01  *** < 0.001 coef(result) #>  #> Coefficients from lmFScreen #> ---------------------------- #>   Predictor Selective.Est  Naive.Est #> 1        X1    0.41583884 0.62940775 #> 2        X2    0.53270730 0.82372146 #> 3        X3    0.18866028 0.27785611 #> 4        X4    0.03454731 0.05025831 #> 5        X5    0.13374114 0.17069581 confint(result) #>  #> lmFScreen Model Confidence Intervals #> ------------------------------------------------------ #> Confidence Level: 95.00% #> Number of predictors: 5 #> ------------------------------------------------------ #>  #> Selective Confidence Intervals: #> Predictor       Lower.CI     Upper.CI #> --------------------------------------------- #>  X1                -0.2833        1.3457 #>  X2                -0.1291        1.4702 #>  X3                -0.2351        0.7115 #>  X4                -0.5122        0.6010 #>  X5                -0.3295        0.6239 #>  #> Standard Confidence Intervals: #> Predictor       Lower.CI     Upper.CI #> --------------------------------------------- #>  X1                -0.0184        1.2772 #>  X2                 0.2247        1.4228 #>  X3                -0.1075        0.6633 #>  X4                -0.4140        0.5145 #>  X5                -0.2236        0.5650 #>  # in Example 3, the selective p-values change significantly from the standard p-values"},{"path":"https://mcgougho.github.io/lmFScreen/reference/print.lmFScreen.html","id":null,"dir":"Reference","previous_headings":"","what":"Print an lmFScreen Fit — print.lmFScreen","title":"Print an lmFScreen Fit — print.lmFScreen","text":"print coefficients lmFScreen model","code":""},{"path":"https://mcgougho.github.io/lmFScreen/reference/print.lmFScreen.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Print an lmFScreen Fit — print.lmFScreen","text":"","code":"# S3 method for class 'lmFScreen' print(object, ...)"},{"path":"https://mcgougho.github.io/lmFScreen/reference/print.lmFScreen.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Print an lmFScreen Fit — print.lmFScreen","text":"object object class lmFScreen containing model results. ... Additional arguments (currently unused).","code":""},{"path":"https://mcgougho.github.io/lmFScreen/reference/print.lmFScreen.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Print an lmFScreen Fit — print.lmFScreen","text":"Invisibly data frame selective estimates","code":""},{"path":"https://mcgougho.github.io/lmFScreen/reference/print.lmFScreen.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Print an lmFScreen Fit — print.lmFScreen","text":"","code":"data(mtcars) result <- lmFScreen(mpg ~ wt + hp, data = mtcars) print(result) #> Selective Estimates: #> Predictor       Estimate  #> --------------------------- #>  wt            -3.877831   #>  hp            -0.031773   #>"},{"path":"https://mcgougho.github.io/lmFScreen/reference/psel_retro.html","id":null,"dir":"Reference","previous_headings":"","what":"Retrospective Selective P-Value Based on Summary Statistics — psel_retro","title":"Retrospective Selective P-Value Based on Summary Statistics — psel_retro","text":"function useful conducting valid retrospective F-screening defined 2025 paper \"Valid F-screening linear regression\" McGough, Witten, Kessler (arxiv preprint: https://arxiv.org/abs/2505.23113). Suppose access outputs \"overall\" least squares linear regression model, output summary(lm(y~X)), want conduct test significance single regression coefficient (beta_j) accounts rejection \"overall\" F-test. function can provide selective p-value beta_j based summary statistics. arguments function include R-squared residual standard error (RSE) overall model (e.g. summary(lm(y~X))), t-statistic test H_0: beta_j=0. function especially useful settings raw data unavailable, published studies.","code":""},{"path":"https://mcgougho.github.io/lmFScreen/reference/psel_retro.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Retrospective Selective P-Value Based on Summary Statistics — psel_retro","text":"","code":"psel_retro(   n,   p,   R_squared,   RSE,   tstat,   sigma_sq = NULL,   alpha_ov = 0.05,   B = 1e+06,   min_select = 1000,   max_attempts = 100 )"},{"path":"https://mcgougho.github.io/lmFScreen/reference/psel_retro.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Retrospective Selective P-Value Based on Summary Statistics — psel_retro","text":"n Sample size (number observations). p Number predictors used \"overall\" least squares linear model (excluding intercept). R_squared R-squared \"overall\" fitted least squares linear model (e.g. summary(lm(y~X))). RSE Residual standard error \"overall\" fitted least squares linear model (e.g. summary(lm(y~X))). tstat Observed t-statistic post hoc hypothesis test beta_j. sigma_sq Optional estimate noise variance. NULL, uses debiased estimate accounts selection. alpha_ov Significance level overall F-test. Default 0.05. B Number Monte Carlo samples per iteration. Default 1,000,000. min_select Minimum number samples satisfying selection condition. Default 1,000. max_attempts Maximum number iterations passing selection criterion giving . Default 100.","code":""},{"path":"https://mcgougho.github.io/lmFScreen/reference/psel_retro.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Retrospective Selective P-Value Based on Summary Statistics — psel_retro","text":"numeric value representing estimated selective p-value. selected samples obtained max_attempts, function returns NA issues warning.","code":""},{"path":"https://mcgougho.github.io/lmFScreen/reference/psel_retro.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Retrospective Selective P-Value Based on Summary Statistics — psel_retro","text":"","code":"data(mtcars) mod <- lm(mpg ~ wt + hp, data = mtcars) rse <- summary(mod)$sigma r2 <- summary(mod)$r.squared t_hp <- summary(mod)$coefficients[\"hp\", \"t value\"] psel_retro(n=nrow(mtcars), p=2, R_squared=r2, RSE=rse, tstat=t_hp) #> [1] 0.001473 result <- lmFScreen(mpg ~ wt + hp, data = mtcars) result[[\"selective pvalues\"]][2] #>       hp  #> 0.001377  # the retrospective and prospective p-values coincide (up to Monte Carlo error)"},{"path":"https://mcgougho.github.io/lmFScreen/reference/summary.lmFScreen.html","id":null,"dir":"Reference","previous_headings":"","what":"Summarize an lmFScreen Model — summary.lmFScreen","title":"Summarize an lmFScreen Model — summary.lmFScreen","text":"Displays structured summary lmFScreen model, including selective naive estimates, confidence intervals, p-values.","code":""},{"path":"https://mcgougho.github.io/lmFScreen/reference/summary.lmFScreen.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Summarize an lmFScreen Model — summary.lmFScreen","text":"","code":"# S3 method for class 'lmFScreen' summary(object, ...)"},{"path":"https://mcgougho.github.io/lmFScreen/reference/summary.lmFScreen.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Summarize an lmFScreen Model — summary.lmFScreen","text":"object object class lmFScreen containing model results. ... Additional arguments (currently unused).","code":""},{"path":"https://mcgougho.github.io/lmFScreen/reference/summary.lmFScreen.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Summarize an lmFScreen Model — summary.lmFScreen","text":"Invisibly returns list containing: Selective: data frame selective estimates, confidence intervals, p-values Standard: data frame standard estimates, confidence intervals, p-values","code":""},{"path":"https://mcgougho.github.io/lmFScreen/reference/summary.lmFScreen.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"Summarize an lmFScreen Model — summary.lmFScreen","text":"output includes: header indicating number predictors table selective estimates confidence intervals p-values table naive estimates confidence intervals p-values Significance stars added p-values: p < 0.05 ** p < 0.01 *** p < 0.001","code":""},{"path":"https://mcgougho.github.io/lmFScreen/reference/summary.lmFScreen.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Summarize an lmFScreen Model — summary.lmFScreen","text":"","code":"data(mtcars) result <- lmFScreen(mpg ~ wt + hp, data = mtcars) summary(result) #> lmFScreen Model Summary  #> -------------------------------------- #> Overall F-statistic:    69.2112 #> -------------------------------------- #>  #> Number of post hoc tests: 2 #> -------------------------------------- #>  #> Selective Estimates: #> Predictor       Estimate     Lower.CI    Upper.CI    P-value #> ------------------------------------------------------------- #>  wt            -3.877831     -5.1729     -2.5866      0.0000*** #>  hp            -0.031773     -0.0502     -0.0133      0.0015** #>  #> Standard Estimates: #> Predictor       Estimate     Lower.CI    Upper.CI    P-value #> ------------------------------------------------------------- #>  wt            -3.877831     -5.1180     -2.6377      0.0000*** #>  hp            -0.031773     -0.0495     -0.0141      0.0015** #>  #>  #> Significance levels: * < 0.05  ** < 0.01  *** < 0.001"}]
